import{j as e,B as f}from"./index-BqjcH8Ld.js";import{r as u}from"./vendor-CDaM45aE.js";import{p as O}from"./productService-H60RsR2R.js";import{P as E}from"./ProductGrid-D03OkL96.js";import{a as z,u as R}from"./router-CmN49VLu.js";import"./utils-ngrFHoWO.js";import"./CreatorVerificationBadge-BEfSH6Wh.js";import"./LazyImage-BBJ-urm_.js";const L=({onFilterChange:r,categories:n=[]})=>{const[o,d]=u.useState({category:"",status:"",minPrice:"",maxPrice:"",sortBy:"createdAt",sortOrder:"desc"}),m=(s,j)=>{const t={...o,[s]:j};d(t),r(t)},g=()=>{const s={category:"",status:"",minPrice:"",maxPrice:"",sortBy:"createdAt",sortOrder:"desc"};d(s),r(s)};return e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md mb-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),e.jsxs("select",{value:o.category,onChange:s=>m("category",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"",children:"All Categories"}),n.map(s=>e.jsx("option",{value:s.name,children:s.name},s._id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:o.status,onChange:s=>m("status",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"Funding",children:"Funding"}),e.jsx("option",{value:"Marketplace",children:"Marketplace"}),e.jsx("option",{value:"Successful",children:"Successful"}),e.jsx("option",{value:"Failed",children:"Failed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Min Price"}),e.jsx("input",{type:"number",value:o.minPrice,onChange:s=>m("minPrice",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",placeholder:"0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Max Price"}),e.jsx("input",{type:"number",value:o.maxPrice,onChange:s=>m("maxPrice",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",placeholder:"1000"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sort By"}),e.jsxs("select",{value:o.sortBy,onChange:s=>m("sortBy",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"createdAt",children:"Date Created"}),e.jsx("option",{value:"price",children:"Price"}),e.jsx("option",{value:"averageRating",children:"Rating"}),e.jsx("option",{value:"views",children:"Popularity"}),e.jsx("option",{value:"currentFunding",children:"Funding Progress"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Order"}),e.jsxs("select",{value:o.sortOrder,onChange:s=>m("sortOrder",s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"desc",children:"Descending"}),e.jsx("option",{value:"asc",children:"Ascending"})]})]})]}),e.jsxs("div",{className:"flex justify-end mt-4 space-x-2",children:[e.jsx(f,{variant:"outline",onClick:g,children:"Clear Filters"}),e.jsx(f,{onClick:()=>r(o),children:"Apply Filters"})]})]})},M=({sortBy:r,sortOrder:n,onSortChange:o})=>e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("label",{htmlFor:"sort-by",className:"mr-2 text-sm font-medium text-gray-700",children:"Sort by:"}),e.jsxs("select",{id:"sort-by",value:r,onChange:d=>o({...n,sortBy:d.target.value}),className:"px-3 py-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"createdAt",children:"Newest"}),e.jsx("option",{value:"price",children:"Price"}),e.jsx("option",{value:"averageRating",children:"Rating"}),e.jsx("option",{value:"views",children:"Popularity"}),e.jsx("option",{value:"currentFunding",children:"Funding Progress"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("label",{htmlFor:"sort-order",className:"mr-2 text-sm font-medium text-gray-700",children:"Order:"}),e.jsxs("select",{id:"sort-order",value:n,onChange:d=>o({...r,sortOrder:d.target.value}),className:"px-3 py-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"desc",children:"Descending"}),e.jsx("option",{value:"asc",children:"Ascending"})]})]})]}),D=({currentPage:r,totalPages:n,onPageChange:o,showFirstLast:d=!0,showPrevNext:m=!0})=>{const g=()=>{const t=[];if(n<=5)for(let c=1;c<=n;c++)t.push(c);else{let c,h;r<=3?(c=1,h=5):r+2>=n?(c=n-4,h=n):(c=r-2,h=r+2);for(let i=c;i<=h;i++)t.push(i)}return t},s=t=>{t>=1&&t<=n&&o(t)};if(n<=1)return null;const j=g();return e.jsxs("div",{className:"flex items-center justify-center space-x-2 mt-6",children:[d&&e.jsx(f,{variant:"outline",size:"sm",onClick:()=>s(1),disabled:r===1,children:"First"}),m&&e.jsx(f,{variant:"outline",size:"sm",onClick:()=>s(r-1),disabled:r===1,children:"Previous"}),j.map(t=>e.jsx(f,{variant:r===t?"primary":"outline",size:"sm",onClick:()=>s(t),children:t},t)),m&&e.jsx(f,{variant:"outline",size:"sm",onClick:()=>s(r+1),disabled:r===n,children:"Next"}),d&&e.jsx(f,{variant:"outline",size:"sm",onClick:()=>s(n),disabled:r===n,children:"Last"})]})},$=()=>{const r=z(),n=R(),[o,d]=u.useState([]),[m,g]=u.useState(!0),[s,j]=u.useState(null),[t,b]=u.useState({}),[c,h]=u.useState({sortBy:"createdAt",sortOrder:"desc"}),[i,v]=u.useState({currentPage:1,totalPages:1,totalProducts:0,hasNextPage:!1,hasPrevPage:!1});u.useEffect(()=>{const a=new URLSearchParams(r.search),l=parseInt(a.get("page"))||1,p=a.get("category")||"",x=a.get("minPrice")||"",y=a.get("maxPrice")||"",k=a.get("status")||"",F=a.get("sortBy")||"createdAt",S=a.get("sortOrder")||"desc",A=a.get("search")||"";b({category:p,minPrice:x,maxPrice:y,status:k,search:A}),h({sortBy:F,sortOrder:S}),v(B=>({...B,currentPage:l}))},[r.search]),u.useEffect(()=>{(async()=>{try{g(!0);const l={page:i.currentPage,limit:12,...t,...c},p=await O.getProducts(l),{products:x,pagination:y}=p.data;d(x||[]),v(y),g(!1)}catch{j("Failed to load products"),g(!1)}})()},[t,c,i.currentPage]),u.useEffect(()=>{const a=new URLSearchParams;Object.entries(t).forEach(([p,x])=>{x&&a.append(p,x)}),Object.entries(c).forEach(([p,x])=>{x&&a.append(p,x)}),i.currentPage>1&&a.append("page",i.currentPage);const l=`/products?${a.toString()}`;n(l,{replace:!0})},[t,c,i.currentPage,n]);const P=a=>{b(a),v(l=>({...l,currentPage:1}))},N=a=>{h(a),v(l=>({...l,currentPage:1}))},w=a=>{v(l=>({...l,currentPage:a}))},C=()=>{n("/compare")};return s?e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error loading products"}),e.jsx("p",{className:"text-gray-600 mb-6",children:s}),e.jsx("button",{onClick:()=>window.location.reload(),className:"text-indigo-600 hover:text-indigo-500 font-medium",children:"Try again"})]})}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"All Products"}),e.jsx("p",{className:"mt-1 text-gray-600",children:"Discover innovative products from creators around the world"})]}),e.jsx("div",{className:"mt-4 md:mt-0",children:e.jsxs("button",{onClick:C,className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})}),"Compare Products"]})})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row gap-8",children:[e.jsx("div",{className:"lg:w-1/4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 sticky top-6",children:[e.jsx("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filters"}),e.jsx(L,{filters:t,onFilterChange:P})]})}),e.jsxs("div",{className:"lg:w-3/4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:(i.currentPage-1)*12+1})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(i.currentPage*12,i.totalProducts)})," ","of ",e.jsx("span",{className:"font-medium",children:i.totalProducts})," products"]})}),e.jsx("div",{className:"mt-4 sm:mt-0",children:e.jsx(M,{sort:c,onSortChange:N})})]}),e.jsx(E,{products:o,loading:m}),i.totalPages>1&&e.jsx("div",{className:"mt-8",children:e.jsx(D,{currentPage:i.currentPage,totalPages:i.totalPages,hasNextPage:i.hasNextPage,hasPrevPage:i.hasPrevPage,onPageChange:w})})]})]})]})};export{$ as default};
